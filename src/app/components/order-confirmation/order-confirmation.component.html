<div class="container mx-auto p-4 max-w-4xl">
  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-8">
    <app-loading-spinner />
  </div>

  <!-- Error State -->
  <div
    *ngIf="error"
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"
  >
    {{ error }}
  </div>

  <!-- Order Details -->
  <div *ngIf="order && !loading">
    <h1 class="text-2xl font-bold mb-6">Order Confirmation</h1>

    <div class="bg-zinc-50 rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4 text-teal-700 capitalize">
        Your Order is placed successfully
      </h2>
      <p class="mb-2">
        <span class="font-semibold">Status: </span> {{ order.orderStatus }}
      </p>
      <p class="mb-2">
        <span class="font-semibold">Date:</span> {{ order.createdAt | date }}
      </p>
      <p>
        <span class="font-semibold">Payment Method:</span>
        {{
          order.paymentMethod === "cash" ? "Cash on Delivery" : "Online Payment"
        }}
      </p>
    </div>

    <div class="bg-zinc-50 rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4">Shipping Address</h2>
      <p>{{ order.shippingAddress }}</p>
    </div>

    <div class="bg-zinc-50 rounded-lg shadow p-4 mb-6">
      <h2 class="text-lg font-semibold mb-3">
        Order Items ({{ order.orderItems.length }})
      </h2>
      <div class="space-y-4">
        <div
          *ngFor="let item of order.orderItems"
          class="flex flex-col sm:flex-row gap-4 p-3 border rounded-lg"
        >
          <div
            class="flex-shrink-0 w-full sm:w-24 h-24 bg-gray-100 rounded-lg overflow-hidden"
          >
            <img
              [src]="item.product.thumbnail"
              [alt]="item.product.title"
              class="w-full h-full object-cover"
            />
          </div>

          <div class="flex-1 min-w-0">
            <div class="flex flex-col sm:flex-row sm:justify-between gap-2">
              <h3 class="text-md font-medium truncate text-teal-800">
                {{ item.product.title }}
              </h3>
              <p class="text-md font-medium whitespace-nowrap">
                {{ item.product.price * item.quantity | currency : "EGP" }}
              </p>
            </div>

            <div
              class="mt-1 flex flex-col sm:flex-row sm:items-center justify-between gap-2 text-sm text-gray-600"
            >
              <div>
                <span *ngIf="item.product.material">{{
                  item.product.material
                }}</span>
                <span *ngIf="item.product.material && item.product.color">
                  â€¢
                </span>
                <span *ngIf="item.product.color">{{ item.product.color }}</span>
              </div>
              <p class="whitespace-nowrap">
                <span class="text-teal-800 font-semibold">Quantity:</span>
                {{ item.quantity }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Summary Section -->
    <div class="bg-zinc-50 rounded-lg shadow p-6">
      <div class="space-y-2">
        <div class="flex justify-between pt-2 mt-2 border-t border-gray-200">
          <span>Price Before Discount:</span>
          <span>{{ subtotal | currency : "EGP" }}</span>
        </div>
        <div *ngIf="50 > 0" class="flex justify-between">
          <span>Shipping:</span>
          <span>{{ 50 | currency : "EGP" }}</span>
        </div>

        <div
          *ngIf="discountAmount > 0"
          class="flex justify-between text-green-600"
        >
          <span>Discount ({{ discountPercentage }}%):</span>
          <span>- {{ discountAmount | currency : "EGP" }}</span>
        </div>

        <div class="flex justify-between">
          <span class="font-bold">Total:</span>
          <span>{{ totalAfterDiscount | currency : "EGP" }}</span>
        </div>
      </div>
    </div>

    <div class="mt-6 text-center">
      <a
        routerLink="/furnitures"
        class="inline-block main-btn text-white px-6 py-2 rounded"
      >
        Continue Shopping
      </a>
    </div>
  </div>
</div>
